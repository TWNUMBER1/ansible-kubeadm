Using /Users/hsutsungchun/ansible-kubeadm/ansible.cfg as config file

PLAY [all] ************************************************************************************************************************************

TASK [Gathering Facts] ************************************************************************************************************************
ok: [ec2-18-220-174-41.us-east-2.compute.amazonaws.com]
ok: [ec2-13-58-13-217.us-east-2.compute.amazonaws.com]

TASK [reset : Reset cluster] ******************************************************************************************************************
fatal: [ec2-18-220-174-41.us-east-2.compute.amazonaws.com]: FAILED! => {"changed": false, "cmd": "/usr/bin/kudeadm reset", "failed": true, "msg": "[Errno 2] No such file or directory: '/usr/bin/kudeadm'", "rc": 2}
...ignoring
fatal: [ec2-13-58-13-217.us-east-2.compute.amazonaws.com]: FAILED! => {"changed": false, "cmd": "/usr/bin/kudeadm reset", "failed": true, "msg": "[Errno 2] No such file or directory: '/usr/bin/kudeadm'", "rc": 2}
...ignoring

TASK [reset : systemctl stop kubelet] *********************************************************************************************************
changed: [ec2-18-220-174-41.us-east-2.compute.amazonaws.com] => {"changed": true, "cmd": "for i in $(/usr/bin/systemctl list-unit-files --no-legend --no-pager -l | grep --color=never -o *.*.slice | grep kubepod); do echo $i; systemctl stop $i; done", "delta": "0:00:00.003428", "end": "2017-09-03 16:08:12.863104", "rc": 0, "start": "2017-09-03 16:08:12.859676", "stderr": "/bin/sh: 1: /usr/bin/systemctl: not found", "stderr_lines": ["/bin/sh: 1: /usr/bin/systemctl: not found"], "stdout": "", "stdout_lines": []}
changed: [ec2-13-58-13-217.us-east-2.compute.amazonaws.com] => {"changed": true, "cmd": "for i in $(/usr/bin/systemctl list-unit-files --no-legend --no-pager -l | grep --color=never -o *.*.slice | grep kubepod); do echo $i; systemctl stop $i; done", "delta": "0:00:00.005070", "end": "2017-09-03 16:08:12.893313", "rc": 0, "start": "2017-09-03 16:08:12.888243", "stderr": "/bin/sh: 1: /usr/bin/systemctl: not found", "stderr_lines": ["/bin/sh: 1: /usr/bin/systemctl: not found"], "stdout": "", "stdout_lines": []}

TASK [reset : remove pacakges] ****************************************************************************************************************
changed: [ec2-18-220-174-41.us-east-2.compute.amazonaws.com] => (item=kubelet) => {"changed": true, "item": "kubelet", "stderr": "", "stderr_lines": [], "stdout": "Reading package lists...\nBuilding dependency tree...\nReading state information...\nThe following packages were automatically installed and are no longer required:\n  ebtables socat\nUse 'sudo apt autoremove' to remove them.\nThe following packages will be REMOVED:\n  kubeadm kubelet\n0 upgraded, 0 newly installed, 2 to remove and 9 not upgraded.\nAfter this operation, 218 MB disk space will be freed.\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 76368 files and directories currently installed.)\r\nRemoving kubeadm (1.7.5-00) ...\r\nRemoving kubelet (1.7.5-00) ...\r\n", "stdout_lines": ["Reading package lists...", "Building dependency tree...", "Reading state information...", "The following packages were automatically installed and are no longer required:", "  ebtables socat", "Use 'sudo apt autoremove' to remove them.", "The following packages will be REMOVED:", "  kubeadm kubelet", "0 upgraded, 0 newly installed, 2 to remove and 9 not upgraded.", "After this operation, 218 MB disk space will be freed.", "(Reading database ... ", "(Reading database ... 5%", "(Reading database ... 10%", "(Reading database ... 15%", "(Reading database ... 20%", "(Reading database ... 25%", "(Reading database ... 30%", "(Reading database ... 35%", "(Reading database ... 40%", "(Reading database ... 45%", "(Reading database ... 50%", "(Reading database ... 55%", "(Reading database ... 60%", "(Reading database ... 65%", "(Reading database ... 70%", "(Reading database ... 75%", "(Reading database ... 80%", "(Reading database ... 85%", "(Reading database ... 90%", "(Reading database ... 95%", "(Reading database ... 100%", "(Reading database ... 76368 files and directories currently installed.)", "Removing kubeadm (1.7.5-00) ...", "Removing kubelet (1.7.5-00) ..."]}
changed: [ec2-13-58-13-217.us-east-2.compute.amazonaws.com] => (item=kubelet) => {"changed": true, "item": "kubelet", "stderr": "", "stderr_lines": [], "stdout": "Reading package lists...\nBuilding dependency tree...\nReading state information...\nThe following packages were automatically installed and are no longer required:\n  ebtables socat\nUse 'sudo apt autoremove' to remove them.\nThe following packages will be REMOVED:\n  kubeadm kubelet\n0 upgraded, 0 newly installed, 2 to remove and 34 not upgraded.\nAfter this operation, 218 MB disk space will be freed.\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 52034 files and directories currently installed.)\r\nRemoving kubeadm (1.7.5-00) ...\r\nRemoving kubelet (1.7.5-00) ...\r\n", "stdout_lines": ["Reading package lists...", "Building dependency tree...", "Reading state information...", "The following packages were automatically installed and are no longer required:", "  ebtables socat", "Use 'sudo apt autoremove' to remove them.", "The following packages will be REMOVED:", "  kubeadm kubelet", "0 upgraded, 0 newly installed, 2 to remove and 34 not upgraded.", "After this operation, 218 MB disk space will be freed.", "(Reading database ... ", "(Reading database ... 5%", "(Reading database ... 10%", "(Reading database ... 15%", "(Reading database ... 20%", "(Reading database ... 25%", "(Reading database ... 30%", "(Reading database ... 35%", "(Reading database ... 40%", "(Reading database ... 45%", "(Reading database ... 50%", "(Reading database ... 55%", "(Reading database ... 60%", "(Reading database ... 65%", "(Reading database ... 70%", "(Reading database ... 75%", "(Reading database ... 80%", "(Reading database ... 85%", "(Reading database ... 90%", "(Reading database ... 95%", "(Reading database ... 100%", "(Reading database ... 52034 files and directories currently installed.)", "Removing kubeadm (1.7.5-00) ...", "Removing kubelet (1.7.5-00) ..."]}
changed: [ec2-18-220-174-41.us-east-2.compute.amazonaws.com] => (item=kubectl) => {"changed": true, "item": "kubectl", "stderr": "", "stderr_lines": [], "stdout": "Reading package lists...\nBuilding dependency tree...\nReading state information...\nThe following packages were automatically installed and are no longer required:\n  ebtables socat\nUse 'sudo apt autoremove' to remove them.\nThe following packages will be REMOVED:\n  kubectl\n0 upgraded, 0 newly installed, 1 to remove and 9 not upgraded.\nAfter this operation, 72.4 MB disk space will be freed.\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 76365 files and directories currently installed.)\r\nRemoving kubectl (1.7.5-00) ...\r\n", "stdout_lines": ["Reading package lists...", "Building dependency tree...", "Reading state information...", "The following packages were automatically installed and are no longer required:", "  ebtables socat", "Use 'sudo apt autoremove' to remove them.", "The following packages will be REMOVED:", "  kubectl", "0 upgraded, 0 newly installed, 1 to remove and 9 not upgraded.", "After this operation, 72.4 MB disk space will be freed.", "(Reading database ... ", "(Reading database ... 5%", "(Reading database ... 10%", "(Reading database ... 15%", "(Reading database ... 20%", "(Reading database ... 25%", "(Reading database ... 30%", "(Reading database ... 35%", "(Reading database ... 40%", "(Reading database ... 45%", "(Reading database ... 50%", "(Reading database ... 55%", "(Reading database ... 60%", "(Reading database ... 65%", "(Reading database ... 70%", "(Reading database ... 75%", "(Reading database ... 80%", "(Reading database ... 85%", "(Reading database ... 90%", "(Reading database ... 95%", "(Reading database ... 100%", "(Reading database ... 76365 files and directories currently installed.)", "Removing kubectl (1.7.5-00) ..."]}
ok: [ec2-18-220-174-41.us-east-2.compute.amazonaws.com] => (item=kubeadm) => {"changed": false, "item": "kubeadm"}
changed: [ec2-13-58-13-217.us-east-2.compute.amazonaws.com] => (item=kubectl) => {"changed": true, "item": "kubectl", "stderr": "", "stderr_lines": [], "stdout": "Reading package lists...\nBuilding dependency tree...\nReading state information...\nThe following packages were automatically installed and are no longer required:\n  ebtables socat\nUse 'sudo apt autoremove' to remove them.\nThe following packages will be REMOVED:\n  kubectl\n0 upgraded, 0 newly installed, 1 to remove and 34 not upgraded.\nAfter this operation, 72.4 MB disk space will be freed.\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 52031 files and directories currently installed.)\r\nRemoving kubectl (1.7.5-00) ...\r\n", "stdout_lines": ["Reading package lists...", "Building dependency tree...", "Reading state information...", "The following packages were automatically installed and are no longer required:", "  ebtables socat", "Use 'sudo apt autoremove' to remove them.", "The following packages will be REMOVED:", "  kubectl", "0 upgraded, 0 newly installed, 1 to remove and 34 not upgraded.", "After this operation, 72.4 MB disk space will be freed.", "(Reading database ... ", "(Reading database ... 5%", "(Reading database ... 10%", "(Reading database ... 15%", "(Reading database ... 20%", "(Reading database ... 25%", "(Reading database ... 30%", "(Reading database ... 35%", "(Reading database ... 40%", "(Reading database ... 45%", "(Reading database ... 50%", "(Reading database ... 55%", "(Reading database ... 60%", "(Reading database ... 65%", "(Reading database ... 70%", "(Reading database ... 75%", "(Reading database ... 80%", "(Reading database ... 85%", "(Reading database ... 90%", "(Reading database ... 95%", "(Reading database ... 100%", "(Reading database ... 52031 files and directories currently installed.)", "Removing kubectl (1.7.5-00) ..."]}
ok: [ec2-13-58-13-217.us-east-2.compute.amazonaws.com] => (item=kubeadm) => {"changed": false, "item": "kubeadm"}
changed: [ec2-18-220-174-41.us-east-2.compute.amazonaws.com] => (item=kubernetes-cni) => {"changed": true, "item": "kubernetes-cni", "stderr": "", "stderr_lines": [], "stdout": "Reading package lists...\nBuilding dependency tree...\nReading state information...\nThe following packages were automatically installed and are no longer required:\n  ebtables socat\nUse 'sudo apt autoremove' to remove them.\nThe following packages will be REMOVED:\n  kubernetes-cni\n0 upgraded, 0 newly installed, 1 to remove and 9 not upgraded.\nAfter this operation, 42.7 MB disk space will be freed.\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 76364 files and directories currently installed.)\r\nRemoving kubernetes-cni (0.5.1-00) ...\r\n", "stdout_lines": ["Reading package lists...", "Building dependency tree...", "Reading state information...", "The following packages were automatically installed and are no longer required:", "  ebtables socat", "Use 'sudo apt autoremove' to remove them.", "The following packages will be REMOVED:", "  kubernetes-cni", "0 upgraded, 0 newly installed, 1 to remove and 9 not upgraded.", "After this operation, 42.7 MB disk space will be freed.", "(Reading database ... ", "(Reading database ... 5%", "(Reading database ... 10%", "(Reading database ... 15%", "(Reading database ... 20%", "(Reading database ... 25%", "(Reading database ... 30%", "(Reading database ... 35%", "(Reading database ... 40%", "(Reading database ... 45%", "(Reading database ... 50%", "(Reading database ... 55%", "(Reading database ... 60%", "(Reading database ... 65%", "(Reading database ... 70%", "(Reading database ... 75%", "(Reading database ... 80%", "(Reading database ... 85%", "(Reading database ... 90%", "(Reading database ... 95%", "(Reading database ... 100%", "(Reading database ... 76364 files and directories currently installed.)", "Removing kubernetes-cni (0.5.1-00) ..."]}
changed: [ec2-13-58-13-217.us-east-2.compute.amazonaws.com] => (item=kubernetes-cni) => {"changed": true, "item": "kubernetes-cni", "stderr": "", "stderr_lines": [], "stdout": "Reading package lists...\nBuilding dependency tree...\nReading state information...\nThe following packages were automatically installed and are no longer required:\n  ebtables socat\nUse 'sudo apt autoremove' to remove them.\nThe following packages will be REMOVED:\n  kubernetes-cni\n0 upgraded, 0 newly installed, 1 to remove and 34 not upgraded.\nAfter this operation, 42.7 MB disk space will be freed.\n(Reading database ... \r(Reading database ... 5%\r(Reading database ... 10%\r(Reading database ... 15%\r(Reading database ... 20%\r(Reading database ... 25%\r(Reading database ... 30%\r(Reading database ... 35%\r(Reading database ... 40%\r(Reading database ... 45%\r(Reading database ... 50%\r(Reading database ... 55%\r(Reading database ... 60%\r(Reading database ... 65%\r(Reading database ... 70%\r(Reading database ... 75%\r(Reading database ... 80%\r(Reading database ... 85%\r(Reading database ... 90%\r(Reading database ... 95%\r(Reading database ... 100%\r(Reading database ... 52030 files and directories currently installed.)\r\nRemoving kubernetes-cni (0.5.1-00) ...\r\n", "stdout_lines": ["Reading package lists...", "Building dependency tree...", "Reading state information...", "The following packages were automatically installed and are no longer required:", "  ebtables socat", "Use 'sudo apt autoremove' to remove them.", "The following packages will be REMOVED:", "  kubernetes-cni", "0 upgraded, 0 newly installed, 1 to remove and 34 not upgraded.", "After this operation, 42.7 MB disk space will be freed.", "(Reading database ... ", "(Reading database ... 5%", "(Reading database ... 10%", "(Reading database ... 15%", "(Reading database ... 20%", "(Reading database ... 25%", "(Reading database ... 30%", "(Reading database ... 35%", "(Reading database ... 40%", "(Reading database ... 45%", "(Reading database ... 50%", "(Reading database ... 55%", "(Reading database ... 60%", "(Reading database ... 65%", "(Reading database ... 70%", "(Reading database ... 75%", "(Reading database ... 80%", "(Reading database ... 85%", "(Reading database ... 90%", "(Reading database ... 95%", "(Reading database ... 100%", "(Reading database ... 52030 files and directories currently installed.)", "Removing kubernetes-cni (0.5.1-00) ..."]}

TASK [reset : cni0 IP allocation issue] *******************************************************************************************************
 [WARNING]: Consider using file module with state=absent rather than running rm
fatal: [ec2-13-58-13-217.us-east-2.compute.amazonaws.com]: FAILED! => {"changed": true, "cmd": "rm -rf /var/lib/cni/ /var/lib/kubelet/* /etc/cni/ /run/flannel ; ifconfig cni0 down; ifconfig flannel.1 down;", "delta": "0:00:00.032527", "end": "2017-09-03 16:08:25.807914", "failed": true, "rc": 255, "start": "2017-09-03 16:08:25.775387", "stderr": "rm: cannot remove '/var/lib/kubelet/pods/0d12b6e4-90c2-11e7-a9f3-02b77b377326/volumes/kubernetes.io~secret/kube-proxy-token-f7hp7': Device or resource busy\ncni0: ERROR while getting interface flags: No such device\nflannel.1: ERROR while getting interface flags: No such device", "stderr_lines": ["rm: cannot remove '/var/lib/kubelet/pods/0d12b6e4-90c2-11e7-a9f3-02b77b377326/volumes/kubernetes.io~secret/kube-proxy-token-f7hp7': Device or resource busy", "cni0: ERROR while getting interface flags: No such device", "flannel.1: ERROR while getting interface flags: No such device"], "stdout": "", "stdout_lines": []}
...ignoring
fatal: [ec2-18-220-174-41.us-east-2.compute.amazonaws.com]: FAILED! => {"changed": true, "cmd": "rm -rf /var/lib/cni/ /var/lib/kubelet/* /etc/cni/ /run/flannel ; ifconfig cni0 down; ifconfig flannel.1 down;", "delta": "0:00:00.005183", "end": "2017-09-03 16:08:25.947243", "failed": true, "rc": 255, "start": "2017-09-03 16:08:25.942060", "stderr": "cni0: ERROR while getting interface flags: No such device\nflannel.1: ERROR while getting interface flags: No such device", "stderr_lines": ["cni0: ERROR while getting interface flags: No such device", "flannel.1: ERROR while getting interface flags: No such device"], "stdout": "", "stdout_lines": []}
...ignoring

PLAY RECAP ************************************************************************************************************************************
ec2-13-58-13-217.us-east-2.compute.amazonaws.com : ok=5    changed=3    unreachable=0    failed=0   
ec2-18-220-174-41.us-east-2.compute.amazonaws.com : ok=5    changed=3    unreachable=0    failed=0   

